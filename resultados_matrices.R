
# ---------------------------
# MATRIZ ESCENARIO A
# ---------------------------

# matriz obtenida de la simulación
P_A <- matrix(c(1,0.25,0,0.06,0,0,0,0.5,0,0.25,0,0,0,0,0,0.13,0,0,0,0.25,1,0.25,
                0.25,0,0,0,0,0.25,0.5,0,0,0,0,0.06,0.25,1), nrow = 6)

# matriz resultante tras 5, 10, 20 y 50 generaciones
P_A_5 <- P_A^5
P_A_10 <- P_A^10
P_A_20 <- P_A^20
P_A_50 <- P_A^50


# tiempo de absorción
T_A <- matrix(c(0.5,0,0.25,0,0,0,0.13,0,0.25,1,0.25,0.25,0,0,0.25,0.5), 
              nrow = 4)

# F = (I-T)^-t
I <- matrix(c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1), nrow = 4)
F_A <- solve(I-T_A)
# m = 1*F
matriz_1 <- matrix(c(1,1,1,1), nrow = 4)
m <- F_A %*% matriz_1

# ---------------------------
# MATRIZ ESCENARIO C
# ---------------------------

# matriz obtenida de la simulación
P_C <- matrix(c(0.999999967, 0.2501, 0, 0.0625, 0, 0, 0.000000033, 0.4999, 0, 
                0.2500, 0, 0, 0, 0, 0, 0.1250, 0, 0, 0, 0.2500, 0.999999967, 
                0.2499, 0.2501, 0, 0, 0, 6.67*10^(-8), 0.2500, 0.5000, 0, 0, 0,
                0, 0.0625, 0.2499, 1), nrow = 6)

# matriz resultante tras 5, 10, 20 y 50 generaciones
P_C_5 <- P_C^5
P_C_10 <- P_C^10
P_C_20 <- P_C^20
P_C_50 <- P_C^50

# tiempo de absorción
T_C <- matrix(c(0.999999967, 0.2501, 0, 0.0625, 0, 0.000000033, 0.4999, 0,
                0.2500, 0, 0, 0, 0, 0.1250, 0,  0, 0.2500, 0.999999967, 0.2499, 
                0.2501, 0, 0, 6.67*10^(-8), 0.2500, 0.5000), nrow = 5)

# F = (I-T)^-t
I <- matrix(c(1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1), nrow = 5)
F_C <- solve(I-T_C)
# m = 1*F
matriz_1 <- matrix(c(1,1,1,1,1), nrow = 5)
m_C <- F_C %*% matriz_1


# ---------------------------
# MATRIZ ESCENARIO D
# ---------------------------

# matriz obtenida de la simulación
P_D <- matrix(c(0.999999967, 0.250037000, 0, 0.0625, 0, 0, 0.000000033, 
                0.500070933, 0, 0.2500, 0, 0, 0, 0, 0, 0.1250, 0, 0, 0, 
                0.249892033, 0.999999967, 0.2501, 0.2500, 0, 0, 0.000000033, 
                0.000000033, 0.2499, 0.4999, 0, 0, 0, 0, 0.0625, 0.2501, 1), 
              nrow = 6)

# matriz resultante tras 5, 10, 20 y 50 generaciones
P_D_5 <- P_D^5
P_D_10 <- P_D^10
P_D_20 <- P_D^20
P_D_50 <- P_D^50

# tiempo de absorción
T_D <- matrix(c(0.999999967, 0.250037000, 0, 0.0625, 0, 0.000000033,
                0.500070933, 0, 0.2500, 0, 0, 0, 0, 0.1250, 0, 0, 0.249892033, 
                0.999999967, 0.2501, 0.2500, 0, 0.000000033, 0.000000033, 0.2499,
                0.4999), nrow = 5)

# F = (I-T)^-t
I <- matrix(c(1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1), nrow = 5)
F_D <- solve(I-T_D)
# m = 1*F
matriz_1 <- matrix(c(1,1,1,1,1), nrow = 5)
m_D <- F_D %*% matriz_1
